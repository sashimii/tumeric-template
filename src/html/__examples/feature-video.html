<div class="tumeric__styles">
  <div class="container tumeric__component-padding">
    <a class="tumeric__full-component-link" href="{{ cta_link }}">
      <div class="tumeric__video">
        <div class="tumeric__video-box embed-responsive embed-responsive-16by9">
          <video id="tumeric-video" class="embed-responsive-item" poster="{{ video_still_url }}" autoplay loop>
          </video>
        </div>
        <p class="tumeric__video-cta text-center"><a href="{{ cta_link }}">{{ call_to_action }}</a></p>
      </div>
    </a>
  </div>
</div>
<script>
  var tmFeaturedVideo = function() {
    var video = document.getElementById('tumeric-video');
    var windowWidth = Math.max(
      document.body.scrollWidth,
      document.documentElement.scrollWidth,
      document.body.offsetWidth,
      document.documentElement.offsetWidth,
      document.documentElement.clientWidth
  	);

    var imageIfRetina = function(image, breakpoint) {
      var isRetina = function() {
        var minPixelRatio = 1.3;
        return minPixelRatio < window.devicePixelRatio;
      }
      if(isRetina()) {
        return image + '_' + breakpoint + '_@2x' + '.jpg';
      } else {
        return image + '_' + breakpoint + '.jpg';
      }
    }

    var still;
    var source;

    if (windowWidth <= 425) {
      // Mobile
      still = imageIfRetina('{{ video_still_url }}', 'b3');
      source = '{{ video_url_mobile }}';
    } else if (windowWidth > 425 && windowWidth < 1024 ) {
      // Tablets
      still = imageIfRetina('{{ video_still_url }}', 'b2');
      source = '{{ video_url_tablet }}';
    } else {
      // Desktop
      still = imageIfRetina('{{ video_still_url }}', 'b1');
      source = '{{ video_url_desktop }}';
    }

    video.setAttribute('poster', still);
    video.innerHTML += '<source src="' + source + '" type="video/mp4">';
  }
  tmFeaturedVideo();
</script>
